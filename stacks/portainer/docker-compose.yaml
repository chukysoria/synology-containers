---
services:
  portainer:
    image: portainer/portainer-ee:2.38.0-alpine@sha256:10557a0810ff691d35ac0ae6718417f8564cbc9a6e6f516b3f339bbbc6aaf4d7
    networks:
      - frontend
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ${BASE_PATH:-/volume2/docker/}portainer:/data:uid=${PUID:-1029},gid=${PGID:-65536}
    restart: always
    dns:
      - 1.1.1.1
      - 8.8.8.8
    ports:
      - 9443:9443 
    healthcheck:
      test: ["CMD", "nc", "-z", "localhost", "9000"]
      interval: 30s
      timeout: 30s
      retries: 5
      start_period: 2m   
    labels:
      traefik.enable: true
      traefik.http.routers.portainer-rtr.rule: Host(`portainer.${DOMAIN:-boulebar.duckdns.org}`)
      traefik.http.routers.portainer-rtr.service: portainer-svc
      traefik.http.services.portainer-svc.loadbalancer.server.port: 9000

networks:
  frontend:
